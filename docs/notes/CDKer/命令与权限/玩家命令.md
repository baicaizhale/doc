---
title: 玩家命令
createTime: 2025/07/03 12:56:28
permalink: /notes/CDKer/命令与权限/玩家命令/
---
### 玩家命令

本节详细阐述了面向普通玩家的 CDKer 插件命令。这些命令旨在提供便捷的礼品码兑换功能。

* **`/cdk use <CDKCode>`**
    * **描述**: 此命令允许玩家使用一个特定的礼品码来兑换预设的游戏内奖励。
    * **权限要求**: `cdk.use`。默认情况下，所有玩家均拥有此权限。这意味着普通玩家无需额外权限即可执行此兑换操作。
    * **Tab 自动补全策略**: **此命令的 Tab 自动补全功能已被明确禁用。** 这一设计决策旨在确保礼品码的机密性，防止未授权用户通过 Tab 补全机制探测或发现有效的礼品码。因此，玩家在输入此命令时，必须手动输入完整的 `<CDKCode>`。
    * **参数**:
        * `<CDKCode>`: 必需参数。这是您希望兑换的礼品码的精确标识符。此代码必须与 `cdk.yml` 文件中定义的某个礼品码完全匹配。
    * **执行流程**:
        1.  玩家输入 `/cdk use <CDKCode>`。
        2.  插件首先验证玩家是否拥有 `cdk.use` 权限。
        3.  插件检查 `<CDKCode>` 是否存在于 `cdk.yml` 中。
        4.  如果礼品码存在，插件会进一步检查其是否已过期。
        5.  对于 `single`（一次性）类型的礼品码，插件会检查当前玩家是否已在 `used_codes.yml` 中记录为已使用过此礼品码。
        6.  插件检查礼品码的 `remainingUses`（剩余使用次数）是否大于 0。
        7.  所有验证通过后，插件将执行 `cdk.yml` 中为该礼品码绑定的所有命令（由控制台执行），并将 `%player%` 占位符替换为当前玩家的名称。
        8.  礼品码的 `remainingUses` 将减少 1。
        9.  如果礼品码是 `single` 类型，当前玩家将被记录到 `used_codes.yml` 中。
        10. 插件保存 `cdk.yml` 和 `used_codes.yml` 的更改。
        11. 插件向玩家发送一条成功兑换的消息。
        12. 如果 `remainingUses` 减少到 0，该礼品码将从 `cdk.yml` 中移除。
    * **示例**:
        * `/cdk use ONETIME_DIAMOND_CDK` - 兑换名为 `ONETIME_DIAMOND_CDK` 的礼品码。